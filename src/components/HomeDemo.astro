---
// src/components/HomeDemo.astro
// ç”Ÿæˆéš¨æ©Ÿæ³¢å½¢æ•¸æ“š
const bars = Array.from({ length: 100 }).map(() => Math.floor(Math.random() * 60 + 20));
---

<div class="relative w-full max-w-5xl mx-auto perspective-1000 group" id="demo-container">
  
  <!-- ðŸ”¥ ä¿®æ”¹ 1: å·²ç§»é™¤ã€Œå…‰æšˆèƒŒæ™¯ã€div -->

  <!-- 
      ä¸»è¦–çª— 
      ðŸ”¥ ä¿®æ”¹ 2: å°‡ border-slate-700 æ”¹ç‚º border-slate-500 (æ›´æ·ºçš„ç°è‰²é‚Šæ¡†)
  -->
  <div class="relative bg-[#0f172a] rounded-xl border border-slate-500 shadow-2xl overflow-hidden flex flex-col">
    
    <!-- 1. Header -->
    <!-- Header çš„åº•ç·šä¹ŸåŒæ­¥ç¨å¾®èª¿æ·ºä¸€é»ž border-slate-600 -->
    <div class="h-10 bg-[#1e293b] border-b border-slate-600 flex items-center px-4 justify-between shrink-0">
      <div class="flex gap-2">
        <div class="w-3 h-3 rounded-full bg-red-500/80"></div>
        <div class="w-3 h-3 rounded-full bg-yellow-500/80"></div>
        <div class="w-3 h-3 rounded-full bg-green-500/80"></div>
      </div>
      <div class="text-xs text-slate-400 font-mono">demo_project.mp4</div>
      <div class="flex gap-3">
         <div class="bg-blue-600 text-white text-[10px] px-3 py-1 rounded font-bold shadow-lg shadow-blue-500/20">Export</div>
      </div>
    </div>

    <!-- 2. é è¦½å€ (Preview) -->
    <div class="relative aspect-video bg-black overflow-hidden cursor-pointer" id="demo-screen">
        <img 
            src="https://picsum.photos/seed/ocean/1280/720" 
            alt="Demo Video" 
            class="w-full h-full object-cover opacity-80 transition-transform duration-[10s] ease-linear"
            id="demo-video-img"
        />
        
       

        <!-- Big Play Button -->
        <div class="absolute inset-0 flex items-center justify-center transition-opacity duration-300" id="center-play-btn">
            <div class="w-16 h-16 bg-white/10 backdrop-blur-md rounded-full flex items-center justify-center border border-white/20 hover:scale-110 transition-transform">
                <svg class="w-8 h-8 text-white fill-current ml-1" viewBox="0 0 24 24"><path d="M8 5v14l11-7z"/></svg>
            </div>
        </div>

        
    </div>

    <!-- 3. åº•éƒ¨æŽ§åˆ¶èˆ‡æ™‚é–“è»¸ (Timeline) -->
    <!-- é€™è£¡çš„ border-t ä¹Ÿæ”¹ç‚º border-slate-600 ä»¥ä¿æŒä¸€è‡´ -->
    <div class="bg-[#0b1120] border-t border-slate-600 p-4 space-y-4">
        
        <!-- Controls Row -->
        <div class="flex items-center justify-between text-slate-400">
            <div class="flex items-center gap-4">
                <button class="w-8 h-8 rounded-full bg-slate-800 flex items-center justify-center hover:bg-slate-700 hover:text-white transition-colors" id="bottom-play-btn">
                    <svg class="w-4 h-4 fill-current play-icon" viewBox="0 0 24 24"><path d="M8 5v14l11-7z"/></svg>
                    <svg class="w-4 h-4 fill-current pause-icon hidden" viewBox="0 0 24 24"><path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z"/></svg>
                </button>
                <span class="text-xs font-mono" id="time-display">00:02:14 / 00:15:00</span>
            </div>
            
            <div class="flex items-center gap-3">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"/><path d="M15.54 8.46a5 5 0 0 1 0 7.07"/></svg>
                <div class="w-20 h-1 bg-slate-700 rounded-full overflow-hidden">
                    <div class="w-2/3 h-full bg-blue-500"></div>
                </div>
                <div class="px-3 py-1 bg-slate-800 border border-slate-700 rounded text-[10px] text-white">Split</div>
            </div>
        </div>

        <!-- Timeline Visual -->
        <!-- é€™è£¡çš„ border ä¹Ÿç¨å¾®èª¿äº®ä¸€é»ž -->
        <div class="relative h-16 bg-[#1e293b]/50 rounded-lg border border-slate-600/50 overflow-hidden flex items-center">
            
            <!-- æŒ‡é‡ -->
            <div class="absolute left-[30%] top-0 bottom-0 w-[2px] bg-white z-20 shadow-[0_0_10px_rgba(255,255,255,0.5)]">
                <div class="absolute -top-1 -left-[5px] w-3 h-3 bg-white rotate-45 rounded-sm"></div>
            </div>

            <!-- æ³¢å½¢è»Œé“ -->
            <div class="flex items-end h-10 gap-[2px] absolute left-0 top-3 opacity-80 transition-transform will-change-transform" id="wave-track">
                {bars.map((h) => (
                    <div class="w-1 rounded-t-sm bg-gradient-to-t from-blue-600 to-cyan-400" style={`height: ${h}%`}></div>
                ))}
                {bars.map((h) => (
                    <div class="w-1 rounded-t-sm bg-gradient-to-t from-blue-600 to-cyan-400" style={`height: ${h}%`}></div>
                ))}
                 {bars.map((h) => (
                    <div class="w-1 rounded-t-sm bg-gradient-to-t from-blue-600 to-cyan-400" style={`height: ${h}%`}></div>
                ))}
            </div>
            
            <div class="absolute top-0 bottom-0 left-0 w-[30%] bg-black/40 backdrop-blur-[1px] z-10 border-r border-white/20"></div>
        </div>
    </div>

  </div>
</div>

<style>
    @keyframes waveScroll {
        0% { transform: translateX(0); }
        100% { transform: translateX(-33.33%); }
    }
    #wave-track {
        animation: waveScroll 10s linear infinite;
        animation-play-state: paused;
    }
    :global(.is-playing) #wave-track {
        animation-play-state: running;
    }
    :global(.is-playing) #center-play-btn {
        opacity: 0;
        pointer-events: none;
    }
    :global(.is-playing) #demo-video-img {
        transform: scale(1.1);
    }
</style>

<script>
    const container = document.getElementById('demo-container');
    const screen = document.getElementById('demo-screen');
    const btn = document.getElementById('bottom-play-btn');
    const playIcon = btn.querySelector('.play-icon');
    const pauseIcon = btn.querySelector('.pause-icon');
    const timeDisplay = document.getElementById('time-display');

    let isPlaying = false;
    let timer;
    let seconds = 134;

    function toggleDemo() {
        isPlaying = !isPlaying;
        if (isPlaying) {
            container.classList.add('is-playing');
            playIcon.classList.add('hidden');
            pauseIcon.classList.remove('hidden');
            startTimer();
        } else {
            container.classList.remove('is-playing');
            playIcon.classList.remove('hidden');
            pauseIcon.classList.add('hidden');
            stopTimer();
        }
    }

    function startTimer() {
        timer = setInterval(() => {
            seconds++;
            const m = Math.floor(seconds / 60).toString().padStart(2, '0');
            const s = (seconds % 60).toString().padStart(2, '0');
            const ms = Math.floor(Math.random() * 99).toString().padStart(2, '0');
            timeDisplay.innerText = `00:${m}:${s}.${ms} / 00:15:00`;
        }, 1000);
    }

    function stopTimer() {
        clearInterval(timer);
    }

    screen.addEventListener('click', toggleDemo);
    btn.addEventListener('click', toggleDemo);
</script>